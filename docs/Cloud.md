## Сервер

На сервере используется [container solution](https://cloud.yandex.ru/docs/cos/). Это значит, что нужны уже собранные образы, благо гитхаб умеет собирать автоматически.

Сборка настроена на пуш в ветки main и deploy. Main для релизов, deploy для спама тестовыми сборками, чтобы каждый раз не тащить мелкие изменения в main. [Инструкция в практикуме](https://practicum.yandex.ru/learn/middle-frontend/courses/e45affa2-2b3d-483e-b7a3-f09b1030d749/sprints/93755/topics/fd99bf9b-add4-4c92-b70d-739d7ecc5418/lessons/d5c7fd34-a7ef-413b-8d86-c6314021ec5a/)

Файл `docker-compose.cloud.yml` - пример того, что используется на сервере.

Проследить прогресс автоматической сборки контейнера можно во вкладке `Actions` на гитхабе

## Пользователи

Чтобы получить доступ к консоли нужно предварительно создать ssh ключ [инструкця](https://juniper-gambler-ec4.notion.site/7eee4ddf74944b9fa55c77feca7f5b95) и попросить того, кто уже имеет доступ.

Права ограниченные, но при необходимости можно переключиться в рут `sudo -i` и вернуться `logout`

Терминал:

```bash
ssh my_name@158.160.68.210
```

## Особенности

`docker-compose` файлы в этом образе временные, они создаются во временных папках при каждом изменении настроек, потому если нужны внешние конфиги, им надо прописывать абсолютные пути, например: `/etc/nginx/default.conf`, плюс лучше сразу делать chmod 777, чтобы потом не искать в чем дело.

## Debugging

Если что-то не запускается, можно посмотреть логи демона:

```bash
sudo journalctl -u yc-container-daemon
```

или логи конкретного контейнера:

```bash
docker container ls -a
#...
docker logs CONTAINER_ID # писать ID целиком не обязательно
```
